{% extends 'layout.html' %}

{% block content %}
    <!-- Centered Container -->
    <div style="display: flex; justify-content: center; align-items: center; height: 100%;">

        <!-- Conversation List -->
        <div style="width: 30%; padding: 20px; box-sizing: border-box; border-right: 1px solid #ccc;">
            <h2>Active Users</h2>
            <ul id="user-list" style="list-style-type: none; padding: 0;">
                <!-- User list will be dynamically added here using JavaScript -->
            </ul>
        </div>

        <!-- Chat Area -->
        <div style="width: 70%; padding: 20px; box-sizing: border-box;">
            <h2>Chat Room</h2>
            <div id="chat-messages" style="overflow-y: auto; max-height: 500px;">
                <!-- Messages will be dynamically added here using JavaScript -->
            </div>
            <div style="margin-top: 10px;">
                <!-- Message Input Form -->
                <form id="message-form">
                    <input type="text" id="message-input" placeholder="Type your message..." style="width: 70%; padding: 8px;">
                    <button type="button" onclick="sendMessage()" style="width: 20%; padding: 8px; background-color: #4CAF50; color: white; border: none; border-radius: 4px;">Send</button>
                </form>
            </div>
        </div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.1.2/socket.io.js"></script>
    <script>
        var socket = io.connect('http://' + document.domain + ':' + location.port);

        function sendMessage() {
            var messageInput = document.getElementById('message-input');
            var message = messageInput.value.trim();

            if (message !== '') {
                var chatMessages = document.getElementById('chat-messages');
                var user = getCurrentUser();

                // Sample format for sent messages
                var sentMessage = '<div style="margin-bottom: 10px;">' +
                                    '<div style="display: inline-block; background-color: white; color: black; padding: 10px; border-radius: 10px;">' +
                                        '<span style="font-size: 12px;">' + user + ': </span>' +
                                        message +
                                    '</div>' +
                                  '</div>';

                chatMessages.innerHTML += sentMessage;
                messageInput.value = '';
                chatMessages.scrollTop = chatMessages.scrollHeight;

                // Send the message to the server
                socket.emit('event', {'name': user, 'message': message});
            }
        }

        // ... (your existing script.js content) ...
    </script>
{% endblock %}
